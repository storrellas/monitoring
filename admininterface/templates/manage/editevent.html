{% extends 'base.html' %}

{% load staticfiles %}
{% load tags %}

{% block contents %}


<script type="text/javascript">
$('document').ready(function(){
	
	// multi check
	$('#selecttag').on('click', function(){
		var $className = "."+$(this).attr("id");
		if($(this).prop("checked"))
		{
			$($className).prop("checked", true);
			var $selno = "";
			$($className).each(function(){
				$selno += $(this).val();
			});
			
			$("#selno").val($selno);
		}
		else
		{
			$($className).prop("checked", false);
			$("#selno").val("");
		}
	});
	
	$('.selecttag').on('click', function()
	{
		var $temp ="";
		
		var $selno = $(this).val();
		var $selAllNo = $('#selno').val();
		
		if($(this).prop("checked"))
		{
			$temp = $selAllNo + $selno;
		}
		else
		{
			$temp = $selAllNo.replace($selno, '');
		}
		
		$("#selno").val($temp);
	});
});
</script>



<div class="wrapper wrapper-content">
	<div class="row">
		<div class="col-lg-12">
			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5>Edit Event</h5>
					<button class="btn btn-sm btn-warning pull-right m-t-n-xs" type="button"
						onclick="on_back()"><strong>Cancel</strong></button>
				</div>
				<div class="ibox-content">
					<div class="col-lg-12">
						<form role="form" id="addNewEventForm" method="post" enctype="multipart/form-data"><input type="hidden" id="INSERTRESULT" >
							<input type="hidden" id="selno" name="selno" value="<?php echo $selno;?>">
							<input type="hidden" id="eventid" name="eventid" value="<?php echo $eventid;?>"> 
							<div class="form-group"><label class="col-sm-2 control-label" style="text-align: right;">
								<b class="required">*</b>Title:</label>
								<div class="col-sm-9">
									<input type="text" placeholder="" class="form-control required" name="title" id="title" value="{{ event.title }}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-2 control-label" style="text-align: right;">
									<b class="required">*</b>PDF:</label>
								<div class="col-sm-9">
									<input type="text" placeholder="" class="form-control" name="pdfurl" id="pdfurl" disabled="disabled" value="{{ event.pdfurl }}">
								</div>
							</div>
							
							<div class="form-group">
								<label class="col-sm-2 control-label" style="text-align: right;"> </label>
								<div class="col-sm-9"><input type="file" class="form-control" name="pdfdocument" id="pdfdocument">
								</div>
							</div>

							<div class="form-group"><label class="col-sm-2 control-label" style="text-align: right;"><b class="required">*</b>Video URL:</label>
								<div class="col-sm-9">
									<input type="text" placeholder="" class="form-control required" name="videourl" id="videourl" value="{{ event.videourl }}">
								</div>
							</div>
							<div class="form-group"><label class="col-sm-2 control-label" style="text-align: right;"><b class="required">*</b>Description:</label>
								<div class="col-sm-9">
									<textarea class="form-control required" name="description" id="description" style="width:100%; height:80px;">{{ event.description }}</textarea>
								</div>
							</div>
							<div style="clear: both;"></div>
							<div class="form-group">
								<label class="col-sm-2 control-label" style="text-align: right;">Users:</label>
								<div class="col-sm-9">
									<table class="table table-bordered" style="margin-bottom: 10px;" id="user_table">
										<thead>
										<tbody id="users_body" style="height: 200px; overflow-y: auto; overflow-x: hidden; display: block;">
											<tr>
												<th style="width: 70px"><input type="checkbox" id="selecttag"></th>
												<th style="width: 70px">No</th>
												<th style="width: 200px">Username</th>
											</tr>
											<tr>
											<?php 
											$no=1;
													foreach ($users as $item)
													{
													?>
	                                        <tr>
	                                        	<td><input type="checkbox" class="selecttag" id="seltag<?php echo $item['userid']?>" 
	                                        		value="<?php echo $item['userid']?>," <?php if ($item['checkflag']) echo 'checked';?>></td>
	                                            <td><?php echo $no?></td>
	                                            <td><?php echo $item['username'];?></td>
	                                        </tr>
	                                        <?php
	                                        	$no++; 
													}
													?>
										</tbody>
									</table>
								</div>
							</div>
							
							<div class="form-group">
								<label class="col-sm-2 control-label" style="text-align: right;"> </label>
								<div class="col-sm-9">
									<button class="btn btn-sm btn-default pull-center m-t-n-xs" style="margin-right: 10px;" type="button" onclick="on_reset()"><strong>Reset</strong> </button>
									<button class="btn btn-sm btn-success pull-center m-t-n-xs" onclick="on_create()"><strong>Save</strong></button>
								</div>
							</div>
							<div style="clear: both;"></div>
						</form>
					</div>
				<div style="clear: both;"></div>
				</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
function on_create()
{
	$('#addNewEventForm').validate({
        errorPlacement: function (error, element) {
            element.before(error);
        },
        
        submitHandler: function() {
        	show_loading(true);
        	$("#addNewEventForm").submit();
        }
    });	
}
// add content
function on_reset()
{
	location.href = location.href;
}
function on_back()
{
	location.href = '<?php echo site_url('event/events/0')?>';
}
$('document').ready(function(){
	
});
</script>

{% endblock %}
